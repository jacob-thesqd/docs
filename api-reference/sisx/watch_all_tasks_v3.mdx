---
title: 'Watch All Tasks V3'
description: 'This N8N workflow, named "Watch All Tasks V3", is designed to process tasks from ClickUp, enrich them with data from Airtable and Dropbox, and update records accordingly. It handles various scenarios, including archiving, checking for specific tags, and managing video-related tasks, ultimately updating Airtable and potentially triggering other automations or notifications.'
api: "POST /enrich-record-manual"
---

## Workflow Details

*   **Workflow ID**: `TLHsRBUWw3klQKo3`
*   **Status**: Active
*   **Tags**: Airtable

## Webhook Endpoints

### Trigger Webhook

```
POST /enrich-record-manual
```

This endpoint is triggered manually to initiate the workflow.

### HookDeck Trigger Webhook

```
POST /enrich-record
```

This endpoint is triggered by HookDeck, likely for automated task creation events.

## Workflow Process

The workflow is triggered by a manual webhook or a HookDeck trigger, initiating a series of data retrieval, filtering, and updating operations.

### 1. Manual Trigger
*   **Type**: Webhook Trigger
*   **Path**: `/enrich-record-manual`
*   **Method**: POST
*   **Purpose**: Manually triggers the workflow to enrich a record.

### 2. HookDeck Trigger
*   **Type**: Webhook Trigger
*   **Path**: `/enrich-record`
*   **Method**: POST
*   **Purpose**: Triggered by HookDeck, likely for automated events like task creation.

### 3. Filter
*   **Type**: Filter
*   **Purpose**: Filters incoming data based on the presence of `recId` and `taskId` in the query parameters.

### 4. Format1
*   **Type**: Set
*   **Purpose**: Extracts and formats `recId`, `taskId`, and `time_estimate` from the incoming webhook payload.

### 5. Format2
*   **Type**: Set
*   **Purpose**: Extracts and formats `recId` and `taskId` from the incoming query parameters.

### 6. Format
*   **Type**: Set
*   **Purpose**: Formats `recId`, `taskId`, and `time_estimate` for downstream processing.

### 7. Airtable
*   **Type**: Airtable
*   **Operation**: Retrieves a record from Airtable using the `recId`.

### 8. Get CU Task
*   **Type**: ClickUp
*   **Operation**: Fetches task details from ClickUp using the `taskId`.

### 9. Merge1
*   **Type**: Merge
*   **Purpose**: Combines data from the Airtable and ClickUp Get nodes.

### 10. Execute Workflow
*   **Type**: Execute Workflow
*   **Workflow ID**: `FqUltzQvzxGiCqyk` (Search Assignees API)
*   **Purpose**: Executes a sub-workflow to search for assignees based on task data.

### 11. No Operation, do nothing
*   **Type**: No Operation
*   **Purpose**: A placeholder node, likely for branching logic or debugging.

### 12. Check if Not Archived
*   **Type**: If
*   **Condition**: Checks if the `archived` field is `false`.
*   **Purpose**: Controls the workflow path for tasks that are not archived.

### 13. Delete Airtable Record
*   **Type**: Airtable
*   **Operation**: Deletes a record from Airtable based on the `recId` obtained from the 'Format' node.
*   **On Error**: Continues with regular output.

### 14. Stay w/ Branch 1
*   **Type**: Merge
*   **Purpose**: Merges data from different branches of the workflow.

### 15. If4
*   **Type**: If
*   **Condition**: Checks if a Dropbox Folder ID exists in the `custom_fields` of the ClickUp task.
*   **Purpose**: Determines the next step based on whether a Dropbox Folder ID is available.

### 16. Get DB Folder ID from ShareURL
*   **Type**: HTTP Request
*   **URL**: `https://api.dropboxapi.com/2/sharing/get_shared_link_metadata`
*   **Method**: POST
*   **Purpose**: Retrieves metadata for a Dropbox shared link.

### 17. Dropbox2
*   **Type**: Dropbox
*   **Resource**: Search
*   **Purpose**: Searches for a folder in Dropbox using the task's name.

### 18. Edit Fields2
*   **Type**: Set
*   **Purpose**: Extracts and formats the "GoLive Date" from the task's text content.

### 19. If1
*   **Type**: If
*   **Conditions**:
    *   Checks if the length of `go_live` data is greater than 2.
    *   Checks if a Dropbox Folder ID (obtained from either Get DB Folder ID or Dropbox2) is present.
*   **Purpose**: Controls the workflow path for tasks with GoLive dates and a valid Dropbox Folder ID.

### 20. Update Airtable Record
*   **Type**: Airtable
*   **Operation**: Updates an Airtable record with various task details, including tags, client information, dates, and Dropbox Folder ID.

### 21. Update Airtable Record w/o Go Live
*   **Type**: Airtable
*   **Operation**: Updates an Airtable record with task details, excluding the "Go Live Date".

### 22. Postgres3
*   **Type**: PostgreSQL
*   **Operation**: Inserts or updates a `go_live_dates` record in the PostgreSQL database with the task ID and formatted Go Live date.

### 23. Get Accounts
*   **Type**: Airtable
*   **Operation**: Searches for account information in Airtable based on the ClickUp Folder ID.

### 24. Switch
*   **Type**: Switch
*   **Condition**: Checks if the `C-Squad Contact(s)` field is present in the account data.
*   **Purpose**: Routes the workflow based on whether a C-Squad contact is assigned.

### 25. Get Employee
*   **Type**: Airtable
*   **Operation**: Searches for employee information in Airtable based on the preferred C-Squad contact.

### 26. Tag User Message
*   **Type**: Slack
*   **Purpose**: Sends a Slack message to the identified C-Squad user, notifying them of a new comms\_plan task.

### 27. Generic Message
*   **Type**: Slack
*   **Purpose**: Sends a generic Slack message to the PM channel when a comms\_plan task is submitted without a specific C-Squad contact.

### 28. Check for comms_plan Tag
*   **Type**: Filter
*   **Condition**: Checks if the task tags contain "comms\_plan" (case-insensitive).
*   **Purpose**: Filters tasks that require a Slack notification for comms\_plan submissions.

### 29. Remove "Download Video Reminder" projects1
*   **Type**: Filter
*   **Conditions**:
    *   Filters out tasks where the name contains "Download Video Reminder".
    *   Ensures a specific custom field (`e713b55c-8a45-479f-b565-8f035276db6e`) exists.
*   **Purpose**: Excludes specific types of tasks from further processing.

### 30. If Video Squad
*   **Type**: If
*   **Conditions**: Checks if the task belongs to the "Video Squad" based on tags or custom fields.
*   **Purpose**: Controls workflow execution for video-related tasks.

### 31. Edit Fields
*   **Type**: Set
*   **Purpose**: Sets specific fields for the "create_video_folders" event, including the project name.

### 32. Dropbox
*   **Type**: Dropbox
*   **Operation**: Lists folders in Dropbox based on the obtained Folder ID and project name.

### 33. Get Key
*   **Type**: PostgreSQL
*   **Operation**: Executes a SQL query to retrieve a decrypted secret key from the vault.

### 34. Copy Template Folders
*   **Type**: AWS Lambda
*   **Function**: `video_automation`
*   **Payload**: Contains details about the source, path, project name, and key for copying template folders.
*   **Purpose**: Initiates an AWS Lambda function to automate the copying of template folders.

### 35. Wait2
*   **Type**: Wait
*   **Purpose**: Pauses the workflow execution for a specified duration.

### 36. Airtable2
*   **Type**: Airtable
*   **Operation**: Updates an Airtable record to mark that "Video Template Folders" have been created.

### 37. Postgres1
*   **Type**: PostgreSQL
*   **Operation**: Upserts data into the `project_folders` table in PostgreSQL, storing folder information and task IDs.

### 38. Sticky Note21
*   **Type**: Sticky Note
*   **Content**: Provides guidance on checking for archived status, merging client and task data, responding to the webhook, and deleting records if archived.

### 39. Sticky Note22
*   **Type**: Sticky Note
*   **Content**: Details on getting Dropbox Folder ID from share links and updating Airtable records with additional metadata.

### 40. Sticky Note25
*   **Type**: Sticky Note
*   **Content**: Information about searching clients and employees via the SIS1 Endpoint.

### 41. Sticky Note24
*   **Type**: Sticky Note
*   **Content**: Explains the process of checking for "comms\_plan" tags and sending Slack notifications.

### 42. Sticky Note
*   **Type**: Sticky Note
*   **Content**: Links to the Airtable trigger for viewing.

### 43. Sticky Note26
*   **Type**: Sticky Note
*   **Content**: Refers to "Video Templates".

### 44. No Operation, do nothing1
*   **Type**: No Operation
*   **Purpose**: A placeholder node.

## Data Flow Summary

The workflow generally follows this path:
1.  **Trigger**: Receives data via webhook.
2.  **Initial Formatting**: Extracts key IDs (`recId`, `taskId`) and other relevant data.
3.  **Data Enrichment**: Fetches task details from ClickUp, account information from Airtable, and potentially employee data.
4.  **Conditional Logic**: Branches based on task status (archived or not), presence of specific tags ("comms\_plan"), or task type (video-related).
5.  **Dropbox/Folder Operations**: Retrieves Dropbox folder IDs and, for video tasks, potentially copies template folders using AWS Lambda.
6.  **Database Updates**: Stores processed data, like folder information and Go Live dates, in PostgreSQL.
7.  **Airtable Updates**: Updates Airtable records with the enriched and processed data.
8.  **Notifications**: Sends Slack messages for specific events, such as comms\_plan task submissions.
9.  **Error Handling**: Includes options to continue on error for certain nodes, allowing the workflow to proceed even if some steps fail.