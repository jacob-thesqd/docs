---
title: "MMQ (Webhook3 - PATCH)"
description: "This API is triggered by a PATCH request to the /play-pause endpoint, to control task activities such as play or pause. The workflow processes incoming webhook data, updates task statuses, interacts with Postgres databases for logging, and interfaces with external platforms like ClickUp for task management."
api: "PATCH /play-pause"
---

## Workflow Overview

This workflow is initiated through a webhook (`Webhook3`) which listens for PATCH requests at the `/play-pause` endpoint. It then processes the request data to determine whether to pause or play a task, updates the task status in external platforms like ClickUp, logs activity details within Postgres, and handles various conditionals to maintain task state consistency across integrated systems.

---

## Request Example

<RequestExample>

```bash Request
curl --request POST \
  --url https://your-server-domain.com/play-pause \
  --header "Content-Type: application/json" \
  --data '{
    "id": "86dv8juck",
    "name": "Webhook3",
    "type": "n8n-nodes-base.webhook",
    "parameters": {
      "path": "play-pause",
      "httpMethod": "PATCH",
      "responseMode": "responseNode"
    }
  }'
```

</RequestExample>

---

## 1. Webhook3 (Webhook Trigger)

- **Purpose:** Listens for PATCH requests at `/play-pause`.
- **Parameters:**
  - `path`: `"play-pause"` (the webhook URL path).
  - `httpMethod`: `POST` / `PATCH` (HTTP method).
  - `responseMode`: `"responseNode"` (response handled by downstream nodes).
  - `webhookId`: `"db5c6873-9771-4696-af82-ced1149c1ddf"` (identifier for the webhook node).
- **Functionality:** Receives JSON payload containing at least `id` and `action`. Initiates the process to control task activity based on incoming data.

---

## 2. Switch5 (Determine Action)

- **Purpose:** Routes request based on the `action` parameter (`pause` or `play`).
- **Parameters:**
  - `rules`: 
    - If `body.action` = `"pause"` → output "pause".
    - If `body.action` = `"play"` → output "play".
  - `fallbackOutput`: `"extra"` (for unrecognized actions).
- **Functionality:** Directs the workflow to appropriate branches depending on whether the task should be paused or played.

---

## 3. Edit Fields9 (Set task_id, status, active for pause)

- **Purpose:** Prepare data for updating task status to "on hold".
- **Parameters:**
  - `task_id`: `{{ $json.id }}`
  - `status`: `"on hold"`
  - `active`: `false`
- **Functionality:** Sets up the fields required to update the task in external systems (e.g., ClickUp).

---

## 4. ClickUp (Update task to "on hold")

- **Purpose:** Updates the task in ClickUp to indicate it's paused/inactive.
- **Parameters:**
  - `id`: `{{ $json.id }}`
  - `operation`: `"update"`
  - `updateFields`:
    - `status`: `"on hold"`
- **Credentials:** Utilizes stored API credentials (`TheSquad`).
- **Functionality:** Changes task status to "on hold" in ClickUp via its API.

---

## 5. Postgres11 (Log activity regarding pause)

- **Purpose:** Logs the task pause into the Postgres database.
- **Parameters:**
  - `query`: `INSERT INTO aa_log (action, data, account) VALUES ('pause', '{{ $json.toJsonString() }}', {{ $('Get Account1').item.json.account }});`
  - `operation`: `"update"` (custom insertion may be handled inside nodes).
- **Credentials:** Uses stored database credentials.
- **Functionality:** Records the pause event for historical tracking and audits.

---

## 6. Webhook (Acknowledge)

- **Purpose:** Sends confirmation back to the original requester.
- **Parameters:**
  - `respondWith`: `"json"`
  - `responseBody`: `{"status": "success", "message": "Task paused successfully."}`
- **Functionality:** Provides immediate response indicating successful task pause.

---

## 7. Switch5 (Determine action for play)

- **Purpose:** Routes request based on the `action` parameter (`pause` or `play`).
- **Parameters:**
  - Same as above, but checks if `body.action` = `"play"`.
- **Functionality:** Ensures correct processing path for "play" action.

---

## 8. Edit Fields9 (Set task_id, status, active for play)

- **Purpose:** Prepare data to mark the task as active.
- **Parameters:**
  - `task_id`: `{{ $json.id }}`
  - `status`: `"active"`
  - `active`: `true`
- **Functionality:** Prepares data for updating task status to active in external systems.

---

## 9. ClickUp (Update task to "active")

- **Purpose:** Changes task status back to "active" in ClickUp.
- **Parameters:**
  - `id`: `{{ $json.id }}`
  - `operation`: `"update"`
  - `updateFields`:
    - `status`: `"active"`
- **Credentials:** Same as above.
- **Functionality:** Reactivates the task in ClickUp via API.

---

## 10. Postgres15 (Log activity regarding play)

- **Purpose:** Record the task activation event.
- **Parameters:**
  - `query`: Similar insert statement as pause, but for `"play"` action.
- **Functionality:** Logging state change in activity logs.

---

## 11. Additional Operations (Optional/Post-processing)

- Handling other side effects such as updating task logs, notifying users, or adjusting other internal states based on the action.

---

## 12. Final Webhook Response

- **Response:** "Task resumed" or "Task paused" based on the operation.
- **Parameters:**
  - `respondWith`: `"json"`
  - `responseBody`: `{"status": "success", "action": "{{ $json.body.action }}", "task_id": "{{ $json.id }}"}`

---

This detailed documentation outlines all nodes and actions involved in processing the PATCH request to `/play-pause` for controlling task activity states, interacting with ClickUp, Postgres, and webhook responses to ensure seamless task management automation.