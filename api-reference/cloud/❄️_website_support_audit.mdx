---
title: "‚ùÑÔ∏è Website Support Audit"
description: "This n8n workflow automates the retrieval and updating of website support information. It triggers webhooks to fetch website data and support options, updates website records with selected support options, and sends One-Time Passwords (OTPs) to users, notifying them via Slack after verification against a PostgreSQL database."
api: "POST /wsa-get-websites"
---

## Workflow Details

- **Workflow ID**: `eewvlurllY1aKdn7`
- **Status**: Active
- **Created**: June 10, 2025
- **Last Updated**: June 25, 2025

## Workflow Process

### 1. Get Websites
- **Type**: Webhook Trigger
- **Path**: `/wsa-get-websites`
- **Method**: Triggered via POST request.
- **Purpose**: This node acts as an entry point to fetch website data. It's designed to respond to incoming webhook requests to retrieve information from the "üß© Websites" table in Airtable.

### 2. Websites
- **Type**: Airtable - Get Data
- **Base**: Strategy (`appjHSW7sGtitxoHf`)
- **Table**: üß© Websites (`tblkCFFIUhSA36DK7`)
- **Operation**: Search
- **Purpose**: Retrieves a list of websites from the specified Airtable base and table. This is likely used to populate available website data for further processing or display.

### 3. Get Support Options
- **Type**: Webhook Trigger
- **Path**: `/wsa-get-support-options`
- **Method**: Triggered via POST request.
- **Purpose**: This node serves as an endpoint to retrieve support options. It's configured to fetch data from the "üîë Website Support Options" table in Airtable.

### 4. Support Options
- **Type**: Airtable - Get Data
- **Base**: Strategy (`appjHSW7sGtitxoHf`)
- **Table**: üîë Website Support Options (`tbliWJ8vTvhM0TUVv`)
- **Operation**: Search
- **Purpose**: Fetches the available website support options from Airtable. This data is likely used in conjunction with website records.

### 5. Update Account Support Options
- **Type**: Webhook Trigger
- **Path**: `/wsa-update-website-support-options`
- **Method**: POST
- **Purpose**: This node is triggered to update the support options associated with a specific website. It expects a `websiteRecordId` and an array of `supportOptionIds` in its JSON body.

### 6. Update Websites
- **Type**: Airtable - Edit Record
- **Base**: Strategy (`appjHSW7sGtitxoHf`)
- **Table**: üß© Websites (`tblkCFFIUhSA36DK7`)
- **Operation**: Update
- **Purpose**: Updates a specific website record in the "üß© Websites" Airtable table. It uses the `websiteRecordId` from the incoming webhook data to identify the record and updates the "Website Support Options" field with the provided `supportOptionIds`.

### 7. Send OTP
- **Type**: Webhook Trigger
- **Path**: `/wsa-send-otp`
- **Method**: POST
- **Purpose**: This webhook endpoint is designed to initiate the sending of a One-Time Password (OTP). It expects an email address in its JSON body.

### 8. Code
- **Type**: Code
- **Purpose**: Generates a random 6-digit OTP and prepares it for sending. It takes an email address as input and returns an object containing the email and the generated OTP.

### 9. Postgres
- **Type**: PostgreSQL - Select Data
- **Table**: `employees`
- **Operation**: Select
- **Purpose**: Selects data from the `employees` table in the PostgreSQL database, likely to verify the user's email before sending an OTP. It uses the email received from the "Send OTP" webhook.

### 10. Slack
- **Type**: Slack - Send Message
- **Text**: "Your OTP for the Website Support Dashboard is *{{ $('Code').first().json.otp }}*."
- **User**: The recipient is determined by `user.id` which is mapped from `$json.slack_id`.
- **Purpose**: Sends a direct message to a specified Slack user containing the generated OTP. It confirms the OTP with the user.

### 11. Respond to Webhook
- **Type**: Webhook - Respond
- **Purpose**: This node is configured to respond to webhook triggers. It's set to return "all incoming items," meaning it will send back the data from the preceding node in the execution chain. This node is connected to multiple trigger points, indicating it's used to provide a response to various webhook calls made by the workflow.

## Data Flow

The workflow is designed to handle several distinct operations, each initiated by a specific webhook:

1.  **Fetching Website Data**: A `wsa-get-websites` webhook triggers an Airtable search for website records.
2.  **Fetching Support Options**: A `wsa-get-support-options` webhook triggers an Airtable search for website support options.
3.  **Updating Website Support Options**: A `wsa-update-website-support-options` webhook, when triggered with a website ID and support option IDs, leads to an Airtable update operation on the "üß© Websites" table.
4.  **Sending OTPs**: A `wsa-send-otp` webhook, receiving an email, triggers a code node to generate an OTP. This OTP is then used in a PostgreSQL query to verify the email, and finally, the OTP is sent to the user via Slack.

## Authentication

### Airtable
- **Type**: Airtable OAuth2 API
- **Credential ID**: `jBHiG9dORxXca5We`
- **Name**: Acee's Connection

### PostgreSQL
- **Type**: PostgreSQL
- **Credential ID**: `ckrZxGCgviCXh9wc`
- **Name**: Squad Data

### Slack
- **Type**: Slack API
- **Credential ID**: `ZSsgkHzZgg4NNTmc`
- **Name**: n8n (Bot)